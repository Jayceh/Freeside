<%doc>

The rs_init_object javascript function defined by this include instantiates and
returns a new object for XMLHTTP communication: on Microsoft browsers, an
ActiveXObject ("Msxml2.XMLHTTP" or "Microsoft.XMLHTTP"), or on other browsers,
an XMLHttpRequest object.

Example:

  <& /elements/rs_init_object.html &>

</%doc>
<%shared>
my $initialized = 0; #won't work if component is "preloaded"... so don't do that
</%shared>
% if ( ! $initialized++ ) {
<SCRIPT TYPE="text/javascript">

  function rs_init_object() {
    var A;
    try {
      A=new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
      try {
        A=new ActiveXObject("Microsoft.XMLHTTP");
      } catch (oc) {
        A=null;
      }
    }
    if(!A && typeof XMLHttpRequest != "undefined")
      A = new XMLHttpRequest();
    if (!A)
      alert("Can't create XMLHttpRequest object");
    return A;

  }

</SCRIPT>
% }
